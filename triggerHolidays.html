<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Holiday Approval</title>
  <script>
    window.onload = function() {
      const params = new URLSearchParams(window.location.search);
      
      // extract parameters
      const baseUrl = params.get("baseurl"); 
      const itemid = params.get("itemid"); // read from query string
      
      //buildURL
      const fullUrl = decodeURIComponent(baseUrl) + "&itemid=" + encodeURIComponent(itemid);
      const successString = "The holiday has been approved.<br>You may now close this window.";
      const failedString = "The holiday approval failed. Please try again, or contact your system administrator if the problem persists.";
      
      // do a GET on the url to trigger the flow and change the text displayed on the site.
      fetch(fullUrl, { method: "GET" })
        .then(() => {
          document.getElementById('display-text').innerHTML = successString;
          //document.getElementById('display-text').textContent = successString;
          console.log("The GET request attempt was successful.");
        })
        .catch(() => {
          document.getElementById('display-text').textContent = failedString;
          console.log("The GET request attempt failed.");
        })
        .finally(() => {
          console.log("The GET request attempt has finished.");
        });

    };
  </script>
</head>
<body>
  <div>
    <h1 id="display-text">Loading...</h1>
  </div>
</body>
</html>
