<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Triggering…</title>
  <script>
    // Helper to read query parameters
    function getQueryParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    window.onload = function() {
      // Replace with your base flow URL (without ?itemid)
      const baseUrl = "https://9744aaae77a6ee13b1413d6204afe7.a7.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/e37615bb303045b4b9bbfefea14bca3a/triggers/manual/paths/invoke/?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=dDOIhaTLbKbpOW_w9lYTtP3UBTWhYqaCXGwj7WrNwj8"; 
      const itemid = getQueryParam("itemid"); // read from query string
      const fullUrl = baseUrl + "&itemid=" + encodeURIComponent(itemid);

      // Call the flow endpoint
      fetch(fullUrl, { method: "GET" })
        .finally(() => {
          // Close the tab/window after triggering
          window.close();
        });
    };
  </script>
</head>
<body>
  <p>Triggering… this window will close automatically.</p>
</body>
</html>
